<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Messages</title>

  <!-- Global + Page CSS -->
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/SMS.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="sms-page">

  <!-- Sidebar (drawer on mobile) -->
  <nav class="sidebar" id="sidebar" aria-hidden="true">
    <img src="images/mpnag_logo.png" alt="MPNAG Logo">
    <a href="dashboard.html"><i class="fa fa-gauge"></i> Dashboard</a>
    <a href="student_list.html"><i class="fa fa-users"></i> Student List</a>
    <a href="violation_list.html"><i class="fa fa-exclamation-triangle"></i> Violation List</a>
    <a href="appeals.html"><i class="fa fa-file-circle-question"></i> Appeals</a>
  <a href="SMS.html" class="active"><i class="fa fa-message"></i> Messages &amp; SMS</a>
    <a href="account.html"><i class="fa fa-user-plus"></i> Accounts</a>
    <div class="sidebar-footer">
      <button id="logoutBtn" class="logout-side" type="button">
        <i class="fa fa-sign-out-alt" aria-hidden="true"></i>
        <span>Logout</span>
      </button>
    </div>
</nav>


  <!-- Backdrop for drawer -->
  <div class="backdrop" id="backdrop" aria-hidden="true"></div>

  <!-- Main -->
<div class="main">
  <div class="topbar">
    <button class="menu-btn" aria-label="Open menu" aria-controls="sidebar" aria-expanded="false">
      <i class="fa fa-bars" aria-hidden="true"></i><span> Menu</span>
    </button>
    <h1>Student Discipline Management System</h1>

    <div class="user-area">
      <button class="user-chip" id="userChip" type="button" aria-label="Current user">
        <span class="user-avatar" id="userAvatar">A</span>
        <span class="user-name" id="userName">Admin</span>
      </button>
    </div>
  </div>

    <section class="widget conversation-shell">
      <div class="conversation-layout">
        <aside class="conversation-sidebar">
          <div class="conversation-sidebar__header">
            <h3>Students</h3>
            <p class="hint">Select a student to view conversation history.</p>
          </div>
          <div class="conversation-sidebar__search">
            <label for="studentMessageSearch" class="sr-only">Search students</label>
            <input type="text" id="studentMessageSearch" placeholder="Search" />
          </div>
          <ul id="studentMessageContacts" class="conversation-contact-list">
            <li class="empty">Loading...</li>
          </ul>
        </aside>

        <div class="conversation-main">
          <div class="conversation-header">
            <div>
              <h3 id="studentMessagePartner">Select a student</h3>
              <p class="hint" id="studentMessageMeta">Messages are visible to the selected student.</p>
            </div>
          </div>

          <div class="conversation-body" id="studentMessageThread">
            <p class="hint">Choose a student to start.</p>
          </div>

          <form id="studentMessageForm" class="conversation-form" autocomplete="off">
            <label for="studentMessageInput" class="sr-only">Reply</label>
            <textarea id="studentMessageInput" rows="3" placeholder="Write a reply..." required></textarea>
            <div class="actions">
              <button class="btn primary" type="submit" id="studentMessageSubmit" disabled>
                <i class="fa fa-paper-plane"></i> Send Reply
              </button>
            </div>
          </form>
        </div>
      </div>
    </section>

    <section class="widget">
      <div class="sms-header">
        <h3>Sanction Notice — Parent SMS (One-Way)</h3>
        <button class="btn-icon" id="returnBtn" title="Back to Dashboard" type="button">
          <i class="fa fa-arrow-left"></i>
        </button>
      </div>

      <p class="sms-subtext">Use this module to text parents when a student receives a sanction. Replies are not monitored.</p>

      <div class="sms-container">
        <!-- ================== Form ================== -->
        <div class="sms-form">

          <form id="formPanel" autocomplete="off" novalidate>
            <div class="form-grid">
              <div>
                <label for="phone">Parent's Phone Number:</label>
                <input
                  id="phone"
                  type="tel"
                  inputmode="numeric"
                  maxlength="11"
                  pattern="\d{11}"
                  placeholder="e.g., 09171234567"
                  required
                />
                <small class="help">11 digits, numbers only.</small>
              </div>

              <div>
                <label for="student">Student Name:</label>
                <input id="student" type="text" placeholder="e.g., Juan Dela Cruz" required />
              </div>

              <div>
                <label for="grade">Grade &amp; Section:</label>
                <select id="grade" required>
                  <option value="">— Select Grade &amp; Section —</option>
                  <option>Grade 7 - Section A</option>
                  <option>Grade 8 - Section B</option>
                  <option>Grade 9 - Section C</option>
                  <option>Grade 10 - Section D</option>
                  <option>Grade 11 - ABM</option>
                  <option>Grade 12 - AB2</option>
                </select>
              </div>

              <div>
                <label for="violation">Violation / Incident:</label>
                <select id="violation" required>
                  <option value="">— Select Violation —</option>
                  <option>Bullying</option>
                  <option>Cheating</option>
                  <option>Improper Uniform</option>
                  <option>Tardiness</option>
                  <option>Others</option>
                </select>
              </div>

              <div>
                <label for="sanction">Sanction:</label>
                <select id="sanction" required>
                  <option value="">— Select Sanction —</option>
                  <option>Warning</option>
                  <option>Written Reprimand</option>
                  <option>Extra Homework</option>
                  <option>Suspension</option>
                  <option>Expulsion</option>
                </select>
              </div>

              <div>
                <label for="date">Date of Incident:</label>
                <input id="date" type="date" required />
              </div>

              <div>
                <label for="teacher">Teacher-in-Charge:</label>
                <input id="teacher" type="text" placeholder="e.g., Ms. Santos" required />
              </div>

              <div>
                <label for="template">Violation Type:</label>
                <select id="template">
                  <option value="">— Select Type —</option>
                  <option value="warning">Warning Notice</option>
                  <option value="minor">Minor Offense Notice</option>
                  <option value="major">Major Offense Notice</option>
                  <option value="suspension">Suspension Notice</option>
                </select>
              </div>

              <div class="full">
                <div class="button-row">
                  <button class="btn secondary" id="genBtn" type="button">
                    <i class="fa fa-magic"></i> Generate Message
                  </button>
                  <button class="btn danger" id="resetBtn" type="button">
                    <i class="fa fa-times-circle"></i> Reset
                  </button>
                </div>
              </div>

              <div class="full">
                <label for="message">Message:</label>
                <textarea id="message" rows="6" placeholder="Auto-generated or type custom…"></textarea>

                <!-- live counter (JS updates this) -->
                <div id="counter" class="sms-counter" aria-live="polite">
                  0 characters • 0 SMS segments (160 chars per SMS)
                </div>

                <div class="button-row">
                  <button class="btn primary" id="sendBtn" type="button">
                    <i class="fa fa-paper-plane"></i> Send Sanction SMS
                  </button>
                  <button class="btn outline" id="previewBtn" type="button">
                    <i class="fa fa-eye"></i> Preview Only
                  </button>
                </div>

                <div class="meta-info">
                  <div class="help">
                    POST to <code>/api/sms/sanctions/send</code> with JSON payload (see console log on send).
                  </div>
                </div>
              </div>
            </div>
          </form>
        </div>
        <!-- ================== /Form ================== -->

        <!-- ================== Preview ================== -->
        <aside class="sms-preview">
          <div class="chat-header">SMS — School Discipline</div>
          <div class="sms-bubble" id="chat">
            Hello Parent/Guardian, you will receive important discipline updates here. Replies are not monitored.
            <br>
            <small id="welcomeClock">Today – 04:04 PM</small>
          </div>
        </aside>
      </div> 
    </section>
  </div>

  <script src="js/config.js"></script>
  <script src="js/auth.js" defer></script>
  <script src="js/main.js" defer></script>
  <script type="module" src="js/messages.js"></script>
  <script src="js/SMS.js" defer></script>
</body>
</html>
